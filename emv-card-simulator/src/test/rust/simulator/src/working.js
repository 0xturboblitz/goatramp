ICC:
-70: EMV Proprietary Template
-8F: Certification Authority Public Key Index
-data: [92] = .
-9F32: Issuer Public Key Exponent
-data: [03] = .
-92: Issuer Public Key Remainder
-data: [5F, CE, A1, 52, B4, D9, EC, 97, 91, BF, 30, 96, 72, FA, 51, AF, A9, 56, 2D, 1C, 0B, 33, 3E, D6, 1A, 5A, 20, 00, 40, C3, B5, 0A, 46, 02, 3B, 89] = _.R....0.r.Q..V-..3>..Z..@..F.;.
-90: Issuer Public Key Certificate
-data: [20, 08, FB, 40, DD, A8, 99, 99, AF, 87, 3A, 0D, 9B, AB, 15, 8D, 5A, CE, 11, 34, 4F, E3, 8F, 72, 05, 3C, C5, EC, CF, E4, 96, BB, A5, 8B, 37, D6, 69, BA, B2, CE, AF, 93, 7F, 32, 97, 35, E0, 27, 41, E7, 12, 2C, 83, 2B, E3, 3C, D1, AA, 38, D2, 7C, DA, CC, ED, 8B, 02, F0, EA, 23, 1C, 7C, 6B, CB, F8, 23, 9E, CF, 2C, 11, 95, 4B, 40, 7D, 58, E9, A6, 89, AB, 22, DF, C9, 98, 02, 2A, 17, 9F, AF, C6, 19, AB, C5, AB, 23, 7C, 68, 41, 02, 39, 12, 93, 95, 57, 5E, 62, 3F, 4F, 8B, A8, 38, 0A, 39, 07, AC, F4, 20, 09, B8, C3, D3, 0F, D1, 0F, BB, 91, B1, 3D, C0, 14, B6, 19, BA, 58, 4C, E0, B9, AC, 6F, B1, D3, A4, A7, 45, 03, F6, 90, 88, 7F, 11, 13, 13, D0, 10, A3, A7, 11, 7E, 8C, 04, 44, 87, 46, D3, AA, F8, 88, EA] = 1408 bit key







Issuer Identifier:[12, 34, 56, FF]
Issuer expiry:[12, 30]
Issuer serial:[12, 34, 56]
Issuer hash algo:[01]
Issuer pk algo:[01]
Issuer pk length:[B0]
Issuer pk exp length:[01]
Issuer pk leftmost digits:[E2, B3, CB, 08, DA, 28, EF, 75, FE, 17, 3E, 32, 96, E7, 2A, 70, 10, 2A, 50, 70, EE, D5, D6, 41, EF, 5A, 24, 62, 31, 0F, E5, B3, 60, 10, F2, EC, 60, 65, C4, 07, 49, 52, D1, F5, CB, BB, 41, 6F, F2, 42, 3F, A6, 92, 47, 3B, 72, C3, 6D, 22, 90, 21, 50, 82, 1C, B7, BC, A5, DB, 1D, 2A, F4, 1D, 19, E8, CA, 59, 0C, 63, FF, 26, F8, B1, 2A, 34, 16, A1, DE, F1, 36, 0E, DC, B5, 6A, 68, AC, 00, 7D, 22, 26, D5, 6D, 65, B3, 31, D3, 42, 3C, 62, 87, B7, C4, C4, 2B, 8E, 64, B1, B4, 26, 7A, 0D, 59, BF, F2, A6, C4, 1A, 1E, DB, 0B, FE, DD, E0, 5E, C7, F9, 2E, CE, 81, EB, 65]

------ISSUER PUBLIC KEY------
Issuer PK Modulus: [226, 179, 203, 8, 218, 40, 239, 117, 254, 23, 62, 50, 150, 231, 42, 112, 16, 42, 80, 112, 238, 213, 214, 65, 239, 90, 36, 98, 49, 15, 229, 179, 96, 16, 242, 236, 96, 101, 196, 7, 73, 82, 209, 245, 203, 187, 65, 111, 242, 66, 63, 166, 146, 71, 59, 114, 195, 109, 34, 144, 33, 80, 130, 28, 183, 188, 165, 219, 29, 42, 244, 29, 25, 232, 202, 89, 12, 99, 255, 38, 248, 177, 42, 52, 22, 161, 222, 241, 54, 14, 220, 181, 106, 104, 172, 0, 125, 34, 38, 213, 109, 101, 179, 49, 211, 66, 60, 98, 135, 183, 196, 196, 43, 142, 100, 177, 180, 38, 122, 13, 89, 191, 242, 166, 196, 26, 30, 219, 11, 254, 221, 224, 94, 199, 249, 46, 206, 129, 235, 101, 95, 206, 161, 82, 180, 217, 236, 151, 145, 191, 48, 150, 114, 250, 81, 175, 169, 86, 45, 28, 11, 51, 62, 214, 26, 90, 32, 0, 64, 195, 181, 10, 70, 2, 59, 137]
Issuer PK Exponent: [3]
Censor Sensitive Fields: false
Data Authentication: [95, 36, 3, 24, 17, 48, 90, 8, 18, 52, 86, 0, 18, 52, 86, 8, 95, 52, 1, 1, 159, 7, 2, 255, 128, 142, 20, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 68, 3, 65, 3, 30, 3, 2, 3, 31, 0, 159, 13, 5, 184, 72, 60, 152, 0, 159, 14, 5, 0, 16, 128, 0, 0, 159, 15, 5, 184, 72, 60, 152, 0, 95, 40, 2, 2, 70, 159, 74, 1, 130]
ICC PK Certificate: Some([145, 192, 61, 196, 50, 114, 69, 103, 72, 97, 179, 41, 194, 242, 224, 218, 99, 105, 104, 110, 203, 248, 106, 32, 29, 161, 71, 197, 47, 56, 150, 195, 74, 145, 182, 103, 133, 106, 209, 105, 156, 111, 65, 216, 128, 207, 98, 28, 194, 70, 243, 122, 163, 103, 113, 129, 191, 190, 155, 151, 248, 190, 152, 247, 111, 131, 45, 60, 91, 78, 47, 182, 172, 192, 160, 207, 17, 209, 227, 40, 153, 130, 55, 150, 30, 178, 77, 39, 184, 29, 198, 153, 222, 131, 89, 177, 7, 72, 239, 130, 128, 141, 189, 81, 90, 23, 9, 41, 123, 81, 217, 242, 59, 182, 219, 183, 86, 128, 84, 78, 106, 142, 24, 190, 239, 45, 104, 251, 181, 156, 184, 78, 119, 58, 250, 194, 97, 58, 209, 102, 22, 32, 243, 156, 16, 93, 141, 102, 192, 210, 213, 38, 9, 99, 18, 45, 154, 250, 43, 144, 143, 252, 251, 121, 107, 58, 18, 211, 203, 154, 141, 14, 74, 67, 36, 113])
ICC PK Exponent: Some([3])
Retrieving ICC public key [91, C0]
------ICC PUBLIC KEY------
ICC PAN:[12, 34, 56, 00, 12, 34, 56, 08, FF, FF]
ICC expiry:[12, 29]
ICC serial:[12, 34, 56]
ICC hash algo:[01]
ICC pk algo:[01]
ICC pk length:[80]
ICC pk exp length:[01]
ICC pk leftmost digits:[C0, C3, 22, 9F, B5, DA, 18, D0, 71, 84, 16, DD, 70, C4, 95, B1, 49, 5A, 18, 38, B7, A1, D6, AF, F2, C0, 78, AB, F2, 4D, 30, 73, C0, CB, F1, F8, FB, 7D, 7C, 4E, EF, 92, 5E, 00, C3, 57, B0, 9D, D2, ED, 29, 6B, 15, 89, 8C, C0, 2A, 0A, 68, BE, AE, B5, 96, AE, DF, 7E, 5D, 7A, F7, 71, 8F, 48, E4, D4, B0, 1B, 53, FC, 44, 4E, B5, 81, 2D, 3E, 3B, C1, 86, 93, 8D, 71, 1A, 89, 29, 6D, 80, AA, 4E, D3, 49, B2, 6A, FD, E3, C1, 07, 22, 1B, 98, E8, 0B, EB, 60, 4D, 99, F0, 98, 5D, 43, 48, D4, A7, D9, 1A, DE, A0, 97, 1B, FD, BB, BB, BB, BB, BB, BB]

Challenge: [42, 162, 171, 112, 3, 156, 85, 16]



2023-11-18T13:21:58.066719+03:00 DEBUG emvpt -  -data: [6B, 9D, D0, 64, 45, C8, A7, FF, 90, B7, 9F, C1, 57, 97, 60, 93, 34, 3A, 13, 9D, 0B, 1C, 4D, A1, 56, 5D, 6B, 86, 63, 60, 65, 50, 34, BA, EF, 7A, 84, CF, D2, 22, 4F, 08, 81, A7, C3, B2, 65, 73, 50, A4, D8, D0, 0B, 94, 34, 5E, D0, 86, F0, A1, 45, C1, 00, 45, 0A, 86, C9, 32, C3, 25, 65, 38, A2, E2, C3, 8E, 15, 22, B0, 35, 93, D9, FB, 39, 5C, F7, F2, 62, CC, CF, A1, 7B, 59, 1E, 9D, 66, 5F, 4E, 15, 48, D2, 2C, 4E, 8A, D5, F6, C1, 8D, 16, 77, 90, 8E, F0, 3B, CF, 1B, 3D, 31, 0C, 59, 13, BA, CF, 48, 7C, E8, E7, EE] = k..dE......W.`.4:....M.V]k.c`eP4..z..."O....esP.....4^..E..E...2.%e8....".5...9\..b..{Y..f_N.H.,N......w...;..=1.Y...H|...
  2023-11-18T13:21:58.066787+03:00 DEBUG emvpt -  -9F4C: ICC Dynamic Number
  2023-11-18T13:21:58.066794+03:00 DEBUG emvpt -  -data: [37, 3E] = 7>



  Generate Application Cryptogram (GENERATE AC) - first issuance:
  2023-11-18T13:21:58.066878+03:00 DEBUG emvpt - tag "9F03" has no value, filling with zeros
  2023-11-18T13:21:58.066888+03:00 DEBUG emvpt - cdol_data: [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 70, 0, 0, 0, 0, 0, 9, 120, 32, 7, 36, 33, 1, 35, 69, 103]
  2023-11-18T13:21:58.066895+03:00 DEBUG emvpt - Sending APDU:
  00000000  80 AE 80 00 1D 00 00 00 00 00 01 00 00 00 00 00  | Ç«Ç.↔.....☺..... |
  00000010  00 02 46 00 00 00 00 00 09 78 20 07 24 21 01 23  | .☻F.....○x •$!☺# |
  00000020  45 67 00                                         | Eg.              |
  2023-11-18T13:21:58.067003+03:00 DEBUG emvpt - APDU response status: 9000 - OK
  2023-11-18T13:21:58.067009+03:00 DEBUG emvpt - APDU response(32 bytes):
  00000000  77 1E 9F 27 01 80 9F 36 02 00 F1 9F 26 08 B0 18  | w▲ƒ'☺Çƒ6☻.±ƒ&◘░↑ |
  00000010  91 01 D1 14 16 C1 9F 10 07 06 01 0A 03 A4 A0 02  | æ☺╤¶▬┴ƒ►•♠☺◙♥ñá☻ |
  2023-11-18T13:21:58.067027+03:00 DEBUG emvpt - APDU TLV parse:
  2023-11-18T13:21:58.067031+03:00 DEBUG emvpt - BLABLABLA
  2023-11-18T13:21:58.067040+03:00 DEBUG emvpt - -77: Response Message Template Format 2
  2023-11-18T13:21:58.067046+03:00 DEBUG emvpt -  -9F27: Cryptogram Information Data (CID)
  2023-11-18T13:21:58.067052+03:00 DEBUG emvpt -  -data: [80] = AuthorisationRequestCryptogram
  2023-11-18T13:21:58.067059+03:00 DEBUG emvpt -  -9F36: Application Transaction Counter (ATC)
  2023-11-18T13:21:58.067065+03:00 DEBUG emvpt -  -data: [00, F1] = ..
  2023-11-18T13:21:58.067073+03:00 DEBUG emvpt -  -9F26: Application Cryptogram (AC)
  2023-11-18T13:21:58.067079+03:00 DEBUG emvpt -  -data: [B0, 18, 91, 01, D1, 14, 16, C1] = ........
  2023-11-18T13:21:58.067086+03:00 DEBUG emvpt -  -9F10: Issuer Application Data (IAD)
  2023-11-18T13:21:58.067092+03:00 DEBUG emvpt -  -data: [06, 01, 0A, 03, A4, A0, 02] = .......
  2023-11-18T13:21:58.067099+03:00 DEBUG emvpt - calling validate ac with: AuthorisationRequestCryptogram
  2023-11-18T13:21:58.067105+03:00 DEBUG emvpt - _tag_9f36_application_transaction_counter: [0, 241]
  2023-11-18T13:21:58.067109+03:00 DEBUG emvpt - _tag_9f26_application_cryptogram: Some([176, 24, 145, 1, 209, 20, 22, 193])
  2023-11-18T13:21:58.067114+03:00 DEBUG emvpt - _tag_9f10_issuer_application_data: Some([6, 1, 10, 3, 164, 160, 2])
  2023-11-18T13:21:58.067118+03:00 DEBUG emvpt - icc_cryptogram_type: AuthorisationRequestCryptogram
  2023-11-18T13:21:58.067123+03:00 DEBUG emvpt - icc_cryptogram_type: AuthorisationRequestCryptogram
  2023-11-18T13:21:58.067127+03:00 DEBUG emvpt - settings.terminal.cryptogram_type: AuthorisationRequestCryptogram
  2023-11-18T13:21:58.067131+03:00 DEBUG emvpt - Validating issuer authentication data
  2023-11-18T13:21:58.067135+03:00 DEBUG emvpt - tag_91_issuer_authentication_data: Some([18, 52, 86, 120, 18, 52, 86, 120])
  2023-11-18T13:21:58.067140+03:00 DEBUG emvpt - Sending APDU:
  00000000  00 82 00 00 08 12 34 56 78 12 34 56 78           | .é..◘↕4Vx↕4Vx    |
  2023-11-18T13:21:58.067215+03:00 DEBUG emvpt - APDU response status: 9000 - OK
  2023-11-18T13:21:58.067221+03:00 DEBUG emvpt - APDU response(0 bytes):
  00000000    |  |


  2023-11-18T13:21:58.067227+03:00 DEBUG emvpt - Generate Application Cryptogram (GENERATE AC) - second issuance:
2023-11-18T13:21:58.067248+03:00 DEBUG emvpt - tag "9F03" has no value, filling with zeros
2023-11-18T13:21:58.067257+03:00 DEBUG emvpt - cdol_data: [89, 51, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 70, 0, 0, 0, 0, 0, 9, 120, 32, 7, 36, 33, 1, 35, 69, 103]
2023-11-18T13:21:58.067263+03:00 DEBUG emvpt - Sending APDU:
00000000  80 AE 40 00 1F 59 33 00 00 00 00 00 01 00 00 00  | Ç«@.▼Y3.....☺... |
00000010  00 00 00 02 46 00 00 00 00 00 09 78 20 07 24 21  | ...☻F.....○x •$! |
00000020  01 23 45 67 00                                   | ☺#Eg.            |
2023-11-18T13:21:58.067340+03:00 DEBUG emvpt - APDU response status: 9000 - OK
2023-11-18T13:21:58.067345+03:00 DEBUG emvpt - APDU response(32 bytes):
00000000  77 1E 9F 27 01 40 9F 36 02 00 F2 9F 26 08 B0 18  | w▲ƒ'☺@ƒ6☻.≥ƒ&◘░↑ |
00000010  91 01 D1 14 16 C1 9F 10 07 06 01 0A 03 A4 A0 02  | æ☺╤¶▬┴ƒ►•♠☺◙♥ñá☻ |
2023-11-18T13:21:58.067363+03:00 DEBUG emvpt - APDU TLV parse:
2023-11-18T13:21:58.067367+03:00 DEBUG emvpt - BLABLABLA
2023-11-18T13:21:58.067375+03:00 DEBUG emvpt - -77: Response Message Template Format 2
2023-11-18T13:21:58.067381+03:00 DEBUG emvpt -  -9F27: Cryptogram Information Data (CID)
2023-11-18T13:21:58.067386+03:00 DEBUG emvpt -  -data: [40] = TransactionCertificate
2023-11-18T13:21:58.067394+03:00 DEBUG emvpt -  -9F36: Application Transaction Counter (ATC)
2023-11-18T13:21:58.067399+03:00 DEBUG emvpt -  -data: [00, F2] = ..
2023-11-18T13:21:58.067407+03:00 DEBUG emvpt -  -9F26: Application Cryptogram (AC)
2023-11-18T13:21:58.067413+03:00 DEBUG emvpt -  -data: [B0, 18, 91, 01, D1, 14, 16, C1] = ........
2023-11-18T13:21:58.067420+03:00 DEBUG emvpt -  -9F10: Issuer Application Data (IAD)
2023-11-18T13:21:58.067426+03:00 DEBUG emvpt -  -data: [06, 01, 0A, 03, A4, A0, 02] = .......
2023-11-18T13:21:58.067433+03:00 DEBUG emvpt - calling validate ac with: TransactionCertificate
2023-11-18T13:21:58.067438+03:00 DEBUG emvpt - _tag_9f36_application_transaction_counter: [0, 242]
2023-11-18T13:21:58.067442+03:00 DEBUG emvpt - _tag_9f26_application_cryptogram: Some([176, 24, 145, 1, 209, 20, 22, 193])
2023-11-18T13:21:58.067446+03:00 DEBUG emvpt - _tag_9f10_issuer_application_data: Some([6, 1, 10, 3, 164, 160, 2])
2023-11-18T13:21:58.067451+03:00 DEBUG emvpt - icc_cryptogram_type: TransactionCertificate
2023-11-18T13:21:58.067660+03:00 DEBUG emvpt - Sending APDU:
00000000  00 A4 04 00 07 AF FF FF FF FF 12 34              | .ñ♦.•»....↕4     |
2023-11-18T13:21:58.067755+03:00 DEBUG emvpt - APDU response status: 9000 - OK



-77: Response Message Template Format 2
2023-11-18T13:21:58.068104+03:00 DEBUG emvpt -  -9F4B: Signed Dynamic Application Data
2023-11-18T13:21:58.068123+03:00 DEBUG emvpt -  -data: [6B, 9D, D0, 64, 45, C8, A7, FF, 90, B7, 9F, C1, 57, 97, 60, 93, 34, 3A, 13, 9D, 0B, 1C, 4D, A1, 56, 5D, 6B, 86, 63, 60, 65, 50, 34, BA, EF, 7A, 84, CF, D2, 22, 4F, 08, 81, A7, C3, B2, 65, 73, 50, A4, D8, D0, 0B, 94, 34, 5E, D0, 86, F0, A1, 45, C1, 00, 45, 0A, 86, C9, 32, C3, 25, 65, 38, A2, E2, C3, 8E, 15, 22, B0, 35, 93, D9, FB, 39, 5C, F7, F2, 62, CC, CF, A1, 7B, 59, 1E, 9D, 66, 5F, 4E, 15, 48, D2, 2C, 4E, 8A, D5, F6, C1, 8D, 16, 77, 90, 8E, F0, 3B, CF, 1B, 3D, 31, 0C, 59, 13, BA, CF, 48, 7C, E8, E7, EE] = k..dE......W.`.4:....M.V]k.c`eP4..z..."O....esP.....4^..E..E...2.%e8....".5...9\..b..{Y..f_N.H.,N......w...;..=1.Y...H|...





signature (128 bytes) =[6B, 9D, D0, 64, 45, C8, A7, FF, 90, B7, 9F, C1, 57, 97, 60, 93, 34, 3A, 13, 9D, 0B, 1C, 4D, A1, 56, 5D, 6B, 86, 63, 60, 65, 50, 34, BA, EF, 7A, 84, CF, D2, 22, 4F, 08, 81, A7, C3, B2, 65, 73, 50, A4, D8, D0, 0B, 94, 34, 5E, D0, 86, F0, A1, 45, C1, 00, 45, 0A, 86, C9, 32, C3, 25, 65, 38, A2, E2, C3, 8E, 15, 22, B0, 35, 93, D9, FB, 39, 5C, F7, F2, 62, CC, CF, A1, 7B, 59, 1E, 9D, 66, 5F, 4E, 15, 48, D2, 2C, 4E, 8A, D5, F6, C1, 8D, 16, 77, 90, 8E, F0, 3B, CF, 1B, 3D, 31, 0C, 59, 13, BA, CF, 48, 7C, E8, E7, EE]
=C0C3229FB5DA18D0718416DD70C495B1495A1838B7A1D6AFF2C078ABF24D3073C0CBF1F8FB7D7C4EEF925E00C357B09DD2ED296B15898CC02A0A68BEAEB596AEDF7E5D7AF7718F48E4D4B01B53FC444EB5812D3E3BC186938D711A89296D80AA4ED349B26AFDE3C107221B98E80BEB604D99F0985D4348D4A7D91ADEA0971BFD
= [107, 157, 208, 100, 69, 200, 167, 255, 144, 183, 159, 193, 87, 151, 96, 147, 52, 58, 19, 157, 11, 28, 77, 161, 86, 93, 107, 134, 99, 96, 101, 80, 52, 186, 239, 122, 132, 207, 210, 34, 79, 8, 129, 167, 195, 178, 101, 115, 80, 164, 216, 208, 11, 148, 52, 94, 208, 134, 240, 161, 69, 193, 0, 69, 10, 134, 201, 50, 195, 37, 101, 56, 162, 226, 195, 142, 21, 34, 176, 53, 147, 217, 251, 57, 92, 247, 242, 98, 204, 207, 161, 123, 89, 30, 157, 102, 95, 78, 21, 72, 210, 44, 78, 138, 213, 246, 193, 141, 22, 119, 144, 142, 240, 59, 207, 27, 61, 49, 12, 89, 19, 186, 207, 72, 124, 232, 231, 238]
modulus=135362253209113164836142929847417599068049081750282836314418620176265804533656198308147680572138117228230896618795174349134512308759897452914176852431860685473370067160633397478284638231854333889620976237897812395879211494456464028856749788423557965996372326191226234986624589409240231108419930422758400793597

exponent=3

Message signed (128 bytes)=[
  106, //
  5, // format
  1, // hash algo
  3, // dynamic data size
  81, 55, 62, // dynamic data
  187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187,
  227,
  96, 209, 191, 150, 91, 190, 220, 97, 41, 224, 253, 30, 103, 184, 31, 168, 234, 186, 69, 188
]


[96, 209, 191, 150, 91, 190, 220, 97, 41, 224, 253, 30, 103, 184, 31, 168, 234, 186, 69, 188] (size 20) should be the sha1 of:
5, 1, 3, 81, 55, 62, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 187, 227, + auth_data






